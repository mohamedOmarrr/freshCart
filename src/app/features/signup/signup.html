<section class="flex items-center justify-center my-5 max-w-[95%] m-auto">
  <form
    [formGroup]="signForm"
    (ngSubmit)="submit()"
    class="w-full max-w-md p-6 shadow-md rounded-lg space-y-4 my-5 bg-[rgba(203,218,173,0.6)]"
  >
    <h1 class="text-clay font-goudy text-[25px]">Register Now</h1>
    <p-floatlabel variant="on" class="block mb-4">
      <input
        pInputText
        id="name"
        type="text"
        formControlName="name"
        class="w-full border rounded px-3 py-2"
        autocomplete="off"
      />
      <label for="email">Name</label>
    </p-floatlabel>
    @if(signForm.get('name')?.touched && signForm.get('name')?.invalid){
    <p-message severity="error">Name is required (3-20 characters)</p-message>
    }

    <p-floatlabel variant="on" class="block mb-4">
      <input
        pInputText
        id="email"
        type="email"
        formControlName="email"
        class="w-full border rounded px-3 py-2"
        autocomplete="off"
      />
      <label for="email">Email</label>
    </p-floatlabel>
    @if(signForm.get('email')?.touched && signForm.get('email')?.invalid){
    <p-message severity="error"
      >Enter a valid email, must end with @gmail.com</p-message
    >
    }

    <p-floatlabel variant="on" class="block mb-4 relative">
      <input
        pInputText
        id="password"
        [type]="type"
        formControlName="password"
        class="w-full border rounded px-3 py-2 pr-10"
        autocomplete="new-password"
      />
      <label for="password">Password</label>

      @if(type === 'password'){
      <i
        class="fas fa-eye absolute top-1/2 right-3 -translate-y-1/2 cursor-pointer"
        (click)="type = 'text'"
        (mousedown)="$event.preventDefault()"
      ></i>
      } @else {
      <i
        class="fas fa-eye-slash absolute top-1/2 right-3 -translate-y-1/2 cursor-pointer"
        (click)="type = 'password'"
        (mousedown)="$event.preventDefault()"
      ></i>
      }
    </p-floatlabel>
    @if(signForm.get('password')?.touched && signForm.get('password')?.invalid){
    <p-message severity="error"
      >Password must be at least 6 chars & contains nums & letters</p-message
    >
    }

    <p-floatlabel variant="on" class="block mb-4 relative">
      <input
        pInputText
        id="rePassword"
        [type]="type"
        formControlName="rePassword"
        class="w-full border rounded px-3 py-2 pr-10"
        autocomplete="new-password"
      />
      <label for="password">Re-Password</label>

      @if(type === 'password'){
      <i
        class="fas fa-eye absolute top-1/2 right-3 -translate-y-1/2 cursor-pointer"
        (click)="type = 'text'"
        (mousedown)="$event.preventDefault()"
      ></i>
      } @else {
      <i
        class="fas fa-eye-slash absolute top-1/2 right-3 -translate-y-1/2 cursor-pointer"
        (click)="type = 'password'"
        (mousedown)="$event.preventDefault()"
      ></i>
      }
    </p-floatlabel>
    @if(signForm.get('rePassword')?.touched && signForm.getError('mismatch')){
    <p-message severity="error">Passwords do not match</p-message>
    }

    <p-floatlabel variant="on" class="block mb-4">
      <input
        pInputText
        id="phone"
        type="text"
        formControlName="phone"
        class="w-full border rounded px-3 py-2"
        autocomplete="off"
      />
      <label for="email">Phone</label>
    </p-floatlabel>
    @if(signForm.get('phone')?.touched && signForm.get('phone')?.invalid){
    <p-message severity="error">Enter a valid Egyptian phone number</p-message>
    }

    <button
      type="submit"
      [disabled]="loading()"
      class="w-full font-bold px-4 py-2 font-goudy text-[18px] rounded-lg text-white border-[2px] border-clay bg-[#64684f] hover:bg-[#5d6146] active:scale-[101%] disabled:opacity-50"
    >
      @if(loading()) {
      <div class="flex items-center justify-center">
        <h1>Loading</h1>
        <p-progress-spinner
          strokeWidth="8"
          fill="transparent"
          animationDuration=".5s"
          [style]="{ width: '20px', height: '20px' }"
        />
      </div>
      } @else { Register }
    </button>
    <div class="text-right">
      <a
        routerLink="/log"
        class="text-sm font-bold text-[#5a5a43] hover:underline cursor-pointer"
        >Already have an account?</a
      >
    </div>
  </form>
</section>
